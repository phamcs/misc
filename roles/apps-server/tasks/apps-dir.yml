---
# Create Apps Directory
- name: Create apps directory
  ansible.builtin.file:
    path: "{{ app_dir }}/{{ item }}"
    state: directory
    mode: 0755
    owner: "{{ app_user }}"
    recurse: yes
  loop:
    - compose
    - nginx
    - uptime-kuma
    - grafana
    - influxdb2
    - telegraf
    - vault

# Copy apps stack
- name: Copy Apps stack
  ansible.builtin.copy:
    src: "{{ item.src }}"
    dest: "{{ item.dest }}"
    mode: 0644
    owner: "{{ app_user }}"
  loop:
    - { src: 'files/portainer-stack.yml', dest: '{{ app_dir }}/compose/portainer-stack.yml' }
    - { src: 'files/nginx-stack.yml', dest: '{{ app_dir }}/compose/nginx-stack.yml' }
    - { src: 'files/tig-stack.yml', dest: '{{ app_dir }}/compose/tig-stack.yml' }
    - { src: 'files/uptime-kuma-stack.yml', dest: '{{ app_dir }}/compose/uptime-kuma-stack.yml' }
    - { src: 'files/vault-stack.yml', dest: '{{ app_dir }}/compose/vault-stack.yml' }
  